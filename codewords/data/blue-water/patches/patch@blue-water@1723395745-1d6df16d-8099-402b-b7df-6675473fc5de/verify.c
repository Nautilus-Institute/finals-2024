#include <stdint.h>

#define ROR(x, r) ((x >> r) | (x << (64 - r)))
#define ROL(x, r) ((x << r) | (x >> (64 - r)))
#define R(x, y, k) (x = ROR(x, 8), x += y, x ^= k, y = ROL(y, 5), y ^= x)
#define ROUND(i) R(a,b,i); R(x,y,b); y += token;

__attribute__((always_inline)) uint64_t encode(uint32_t round_num, uint64_t token) {
    uint64_t y = token, x = round_num, b = token, a = round_num;
    
    R(x, y, b);
    ROUND(0);
    ROUND(1);
    ROUND(2);
    ROUND(3);
    ROUND(4);
    ROUND(5);
    ROUND(6);
    ROUND(7);
    ROUND(8);
    ROUND(9);
    ROUND(10);
    ROUND(11);
    ROUND(12);
    ROUND(13);
    ROUND(14);
    ROUND(15);
    ROUND(16);
    ROUND(17);
    ROUND(18);
    ROUND(19);
    ROUND(20);
    ROUND(21);
    ROUND(22);
    ROUND(23);
    ROUND(24);
    ROUND(25);
    ROUND(26);
    ROUND(27);
    ROUND(28);
    ROUND(29);
    ROUND(30);

    return y + token;
}

const uint64_t target[300] = {12360273179459483542ull,13934016975418572686ull,18123634812081312888ull,2017785329001197021ull,17182093739753234691ull,8674547139140119886ull,11689528984758040018ull,9995797421480229893ull,824050056578615416ull,9129558763810333963ull,12545686251798802159ull,8496021580087095977ull,7680810176384588138ull,6326454818045043514ull,12632777497402901731ull,1136274192758494865ull,4894679308416946947ull,4603842880014576268ull,7427266531557920811ull,17170138837202396657ull,14589477644616899866ull,3607830608096371961ull,9570926097782729425ull,13376740870787359018ull,8569650361984707002ull,12370992172221474269ull,9220230784398606814ull,6168611195532466351ull,8037574117318343203ull,2670833348787546360ull,12361088135774823625ull,15174110404936545048ull,7941048312165366845ull,12616552421758648223ull,8141760308554282723ull,3777880412984508302ull,13586224115430314045ull,2743360931594084918ull,1425689059166354823ull,6689762759161692183ull,1481760159713459123ull,2779123058748050482ull,9561741006986095394ull,10440055193147754342ull,5719108656686630547ull,2172639826703594482ull,6391548463580969939ull,1640324064247827165ull,17852392688177960484ull,10539097682142473173ull,1620853357334339393ull,9203419088883986135ull,6550117947378177588ull,5109304858233094142ull,13955892695076493323ull,6297748306651924300ull,6987471875382485581ull,13738991966815565363ull,6993498120437762963ull,4740903432847008497ull,14651389925719609536ull,13097338957090542290ull,12189007810567668850ull,14711417693792995026ull,3698156023879054543ull,3936282374639412619ull,319148221249265023ull,14282972523904872487ull,5428464286803403960ull,15366385947060693397ull,9642224120867838939ull,8052413798132008775ull,1318996063641461074ull,11679370309236257868ull,4566716079436391002ull,7937811342541717995ull,3609363133581947082ull,15122761840347974084ull,4776361392468584002ull,13390090641076771694ull,4566491505953080474ull,4674824128878387493ull,7500052911496365223ull,3402190806291622310ull,14527970068914451910ull,10618157358658595017ull,631250162111951476ull,6581582649181444249ull,6238325578813553156ull,3009124423016406743ull,11189821437333430764ull,13070814664855153822ull,13597073691251104628ull,1313233581590933878ull,10974847130269377290ull,12450467311830026735ull,17957882979679312909ull,5248541457869424131ull,15795948851548721416ull,7491529673007003755ull,228535116787394054ull,3676101121464635004ull,16551548215971467477ull,6224369231072597918ull,2425595449099102868ull,16786802133862708676ull,6381265302740901163ull,4894080751385428965ull,9500077897812088752ull,9043786383616664948ull,10279927206649093981ull,13017853334914625086ull,13852181235466986711ull,6800628346737039191ull,12463098628692359728ull,327759160952292789ull,5556368885344291200ull,7602683503848327162ull,15423640978363259057ull,2258971296130766598ull,13993765227245633055ull,1223086220260500570ull,5241404415854874663ull,3003473251551695228ull,1644997954394490842ull,234722114905623801ull,6407932274737477572ull,5666998324917520068ull,17149643123362003748ull,7747843889774147361ull,413371577586239307ull,18379766851378071678ull,943860795155300514ull,9533503332577918770ull,11646217355511998367ull,18329055969293428371ull,6676470652224369637ull,15709852732604213658ull,3894347719561874313ull,5493597991460739229ull,10318610025770931129ull,13840218133517520787ull,2129865449564653731ull,14024073651158769617ull,1743089389144566570ull,4630587185499443267ull,17837353656248639697ull,5072253137654099321ull,12818443598436186099ull,6169235010182122268ull,4955185672442096893ull,13537631275150658540ull,6448569390481690308ull,7209266262028604009ull,11616767195022458987ull,6171227714687777524ull,1323053923288339742ull,11676750113765686810ull,6264759548733014388ull,11788897398080805454ull,44643405140226564ull,6066340115123779831ull,8005029065452430439ull,17287794920624853778ull,15548048688254109936ull,12590584856571417423ull,15618868612386709092ull,10060258858240188441ull,2894394866647529092ull,8341265450987392856ull,14449964468384161286ull,12275419748613223108ull,9446409466675787890ull,9361398868486523403ull,9255604954600780125ull,17122456057420275618ull,4163097756931579139ull,7347971718255016590ull,10477950873282148841ull,8049896251214020231ull,15934310302044257854ull,9964962345266820910ull,2414567939731872346ull,4916743749429373083ull,17266971116868632082ull,15896165825550059371ull,7184789057421129004ull,13056134405242942402ull,6544986998026022930ull,6182579381271102284ull,2112385341971981796ull,15364649697338631852ull,4215913140365686548ull,17537038729690753303ull,13470220664079145879ull,11431349272650497053ull,16407194818150098624ull,18298237759751893001ull,5053402757704996638ull,12018537685534705474ull,15551377225687930975ull,1175185085978676082ull,9323611526896977968ull,16339417887044816518ull,15541690679930276487ull,11189264339886946461ull,11283360864047892660ull,4532637280406635493ull,17517649722337384119ull,5263823422848165140ull,8992026996645472618ull,1386099988051221842ull,15246093156445012708ull,14125779969313205535ull,6757737004136005992ull,8494221820932415386ull,5327972661229601500ull,13842282271949405167ull,6376353150437097855ull,16447340752050278561ull,8007627157958895822ull,544041850377558973ull,341800781335292978ull,2382327662380665937ull,6481771554616690578ull,14253963396970436756ull,15022678400179463697ull,17270238661547497732ull,18211784027697772850ull,7316855182011242411ull,12706990549734689804ull,11281566279235014722ull,14693910943004608363ull,436045386046772119ull,8713116729783397161ull,12938388509626973796ull,8382371431033233618ull,6381987738469260686ull,12534628962007460388ull,13205003373233945641ull,3689183382214112047ull,3479146091625489660ull,4249984609777850080ull,13803502033217022552ull,11792563500382737307ull,16511507033995863576ull,13390144420429000041ull,8268825108183442844ull,8814835424420155195ull,11938176657954282362ull,9431115257662392764ull,11369622806454301176ull,3910679142145405814ull,7968326472684188186ull,13834874406720202835ull,4635231915064767474ull,6640084270457981043ull,4887009340089313650ull,14305129294046452773ull,12162568934315181956ull,4467741817443381289ull,16172401262808021476ull,2928586455239488941ull,9227806536986614146ull,18411439807525507290ull,3061236769304160126ull,241983247463668161ull,4605264084141455920ull,8355134941380262496ull,15175589638160229060ull,5406750288851873331ull,3855056312698083657ull,4007228334592985086ull,5447562275127483912ull,790118639117265215ull,15070922607546217730ull,6118293363439428443ull,15467135128387342510ull,4652376642419490018ull,17829313413304995629ull,12596140086709075166ull,281396237193102020ull,14894371589169738063ull,10700112912854474640ull,8761913314023709160ull,8709129779949273109ull,14485134921098624437ull,12982964790132353208ull,14315477902738070392ull,7990545328419934435ull,3691660590286512129ull,14966009972235452163ull,7591200821125749535ull,17561960749312816162ull,6846866771073821633ull,3764014038723188110ull,2444164432601478892ull,12046115540446441698ull,6904783302395559414ull,11920578560080486047ull};

uint64_t verify(uint32_t round_num, uint64_t token) {
    return encode(round_num % 300, token) == target[round_num % 300];
}