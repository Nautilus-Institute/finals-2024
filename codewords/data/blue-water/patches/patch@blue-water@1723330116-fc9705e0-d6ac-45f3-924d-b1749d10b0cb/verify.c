#include <stdint.h>

#define ROR(x, r) ((x >> r) | (x << (64 - r)))
#define ROL(x, r) ((x << r) | (x >> (64 - r)))
#define R(x, y, k) (x = ROR(x, 8), x += y, x ^= k, y = ROL(y, 3), y ^= x)
#define ROUND(i) R(a,b,i); R(x,y,b);
#define ROUNDS 32

__attribute__((always_inline)) uint64_t encode(uint32_t round_num, uint64_t token) {
    uint64_t y = token, x = round_num, b = token, a = round_num;
    
    R(x, y, b);
    /*for (int i = 0; i < ROUNDS - 1; i++) {
        R(a, b, i);
        R(x, y, b);
    }*/
ROUND(0);
ROUND(1);
ROUND(2);
ROUND(3);
ROUND(4);
ROUND(5);
ROUND(6);
ROUND(7);
ROUND(8);
ROUND(9);
ROUND(10);
ROUND(11);
ROUND(12);
ROUND(13);
ROUND(14);
ROUND(15);
ROUND(16);
ROUND(17);
ROUND(18);
ROUND(19);
ROUND(20);
ROUND(21);
ROUND(22);
ROUND(23);
ROUND(24);
ROUND(25);
ROUND(26);
ROUND(27);
ROUND(28);
ROUND(29);
ROUND(30);

    return x^y;
}

const uint64_t target[300] = {13033566035564066896ull,10320516500126851392ull,857625023995746101ull,2486308806399781685ull,16652350463495400076ull,70403062671380384ull,4276379873863423607ull,13150137031795168500ull,15608237077514992447ull,7583707130403776861ull,5235060757551107677ull,8793574113722741474ull,4046320314988176606ull,4870378728075213304ull,55831458025156004ull,10998960913876170456ull,6756610316131503722ull,6091221530402666804ull,14620854949930667149ull,15806962071805692620ull,13153534912796062710ull,1424589486505716878ull,14379766836963515144ull,5365945991751547897ull,13967473076290813664ull,18313835535119268981ull,14745082351449923461ull,3627042885178887952ull,7300134667502394596ull,11214252470582329751ull,989098759532506091ull,7895845276688467537ull,4125522570183342407ull,8737356321621251479ull,7434843143228026930ull,280558503684261439ull,16339268267348987413ull,8196445806440306261ull,10460826609554628809ull,14037403519631013102ull,16350659059196051608ull,13759259519261681461ull,15184225094415941785ull,5785440751230380910ull,12672092354104165413ull,16560140142801337718ull,16380821388158351030ull,1214048720480306971ull,13802119865398580308ull,9112047404755833790ull,13927416533547693791ull,718433796706703185ull,147382551565428526ull,16807131086739423838ull,16669632429430730425ull,5337757542733099204ull,13303629628488827162ull,9868286383567294305ull,2882787401755555101ull,6403422378559532684ull,11038329499869231781ull,3322633134541895596ull,3960780675568665993ull,12723621836648037347ull,7430745767557638610ull,11387776061915031227ull,11858997358018034136ull,17354716468803741054ull,16697855272530450536ull,14306609118096584763ull,5549007212622903014ull,6489368678802410122ull,858184961979580751ull,2586081793348224693ull,5431617400910912747ull,7688776545270243540ull,16195574496916866497ull,10629741449768376444ull,17552758874430397628ull,13705102739619351364ull,16981553793440727304ull,9071301174839194635ull,16269041600139551050ull,3367527741916813025ull,4315244661525287896ull,4827612498140562895ull,146054556523004525ull,3087914347238728553ull,822628936061714658ull,12237144317783895611ull,4782315492188805937ull,11681382196782909659ull,3329661017560437582ull,17692106035950596276ull,3379864128787703123ull,14659227992501865372ull,13734103037616221273ull,8607115824775968891ull,9743549740883336153ull,1190324552755608633ull,4253785777664785688ull,15674763539228624391ull,14421105816383493775ull,1801036392060793946ull,7013242104694172751ull,10745443327553853556ull,12968250512279017624ull,17845158081168136211ull,3857695127539589107ull,15458655200940107744ull,4643129556422809812ull,1644122603504076195ull,17104843802167653713ull,7850163073805907434ull,652086939840064286ull,9272821805243964125ull,6636644947693001387ull,4480461735546336493ull,7346884436313603474ull,15549707693322125366ull,13776792655461473771ull,12939622699137913740ull,16915684042589512142ull,3401141577027501012ull,9836451784933254234ull,16491438729178533451ull,16265796366671796701ull,6984657227226556892ull,13325304914328426953ull,9935149358923807271ull,5470714558193721298ull,4078081905423018461ull,12072981628417942051ull,12020011674114795085ull,15140403853864905557ull,4434269223569358701ull,3734843934749355277ull,7599100502751368849ull,16359520676064220592ull,15319799409142554392ull,988029108829894341ull,10802063820897728450ull,6550164624303217531ull,5548721163528412558ull,2779861637421671760ull,16658416229346381946ull,9062630324740716151ull,599387320338734584ull,8480993143841063668ull,18402385402047206158ull,627744317815941036ull,4233081291313014222ull,11926292952608164713ull,10003547188032366961ull,12779247162114702632ull,15108162303745542732ull,7054165150129137311ull,8001788881631249448ull,12584980401938855585ull,15079702706872642794ull,10179677544876810337ull,15362681246961076251ull,5544640957863973635ull,7153491210069864404ull,13337045056666194279ull,9011094246043698297ull,5367915489102005068ull,9229145623757824858ull,8431400315122823630ull,16854264474521805715ull,460527880489622089ull,6897977602407649041ull,5436967661899265956ull,6946978989768581573ull,4078967187255068689ull,13403482324947196095ull,14014600878811300662ull,9623558461965186367ull,10753303137688666238ull,4510201104845987632ull,6793128336467887046ull,7751314085484850712ull,15444928163840149232ull,6274073778866941970ull,15337450256840116562ull,13743384259222161381ull,14669728107957679357ull,17764842890426536191ull,13184127699800268154ull,16278718360351373771ull,1158619437667501627ull,3706845702153253071ull,12840131820350877481ull,18297462260150606850ull,15986839243195698330ull,3024015038132724570ull,12724057330371889605ull,17499295503261530704ull,12281997787733328379ull,7829304544935367664ull,8080514017524135086ull,160395138186306020ull,14570442162182791375ull,12561001724644893379ull,14639494852953855446ull,7986803754218908005ull,13302423255867018225ull,2099276405608203831ull,7129379375709213312ull,16468074284374280938ull,12427167217437204450ull,17981075603290965663ull,94246500168131685ull,8151059022384156561ull,12817053887994932596ull,8429052785636112952ull,10846039785526722480ull,16613031228806270300ull,1869531069874527649ull,12607499016609729195ull,13785355135989866458ull,15165074149002862195ull,17012463853858937987ull,10048895476710427219ull,18150827367786722647ull,5108355357017876650ull,10465138333649590352ull,1263382946382617069ull,1294964891812121632ull,2237494112516123149ull,11783259702955992401ull,5784735945036560794ull,13020489008274937740ull,3999285403083181269ull,10341024177453198282ull,6145417763093279262ull,18409465783353753701ull,17384050182246589122ull,15800017375229447811ull,15458585396015982938ull,16906108880345843004ull,1166572882605038770ull,1868460965549918337ull,5868435334748531982ull,18317149138713451946ull,7357973103663792971ull,14104319400024243175ull,8043640464600717575ull,7964972956098648326ull,18250733245131522864ull,11027916118902758326ull,3562233384363695546ull,8079934460735481235ull,10977893270035418110ull,11052730153103593318ull,17809378547858965195ull,3072934581132212528ull,11579048806351121560ull,4403942117449221119ull,15157810975841123181ull,8557604250180648372ull,17510042151993573682ull,6439231499503864708ull,10022308418813477195ull,12770504180519425332ull,14315254746730183418ull,11695158538145024136ull,14266409798657780862ull,16099355264881100705ull,1062929903311936620ull,10413576133872022596ull,7529191501573820477ull,4607033139224746821ull,7738812230865720688ull,4340734574899417145ull,10445148511232967413ull,14906478425312609423ull,13061110315397686548ull,10112506223154363413ull,14034304707580248905ull,9030883915639126724ull,7448755826675968235ull,15006061107610297590ull,13061938631908987573ull,14982927930400336377ull,2790218929134746770ull,17604924479030097114ull,5468453194682146234ull,1572950468969203169ull,1261746521425007169ull,14555747243223179561ull,17903621613200430430ull,11253363822809386281ull,9277597984214613926ull,17817979675279834690ull,14298154743572340473ull,7135409873959218722ull,1951750690942562186ull,8308308844636036729ull,132791351741301891ull};

uint64_t verify(uint32_t round_num, uint64_t token) {
    uint64_t t=round_num % 300;
    return encode(t, token) == target[t];
}