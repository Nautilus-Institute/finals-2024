
#include <stdint.h>

uint64_t hashes[] = {
    0x1806d84f2bdfaa49ull, 0x81bedfdc1f5b8b2cull, 0x6343ebac510fc554ull, 0xc9423e3b2712fc9ull, 0xc95c2e443c0a9483ull, 0x3d152e46b07dbd2ull, 0x23e7e807254ff974ull, 0xcf329ad57c6808a4ull, 0x5391307e643cacd7ull, 0x56aa6765cd5414b8ull, 0xbfd2554f7373737bull, 0x8d16acd9189e99aaull, 0x2e01f9db84be5c2ull, 0xbcf73694419be26bull, 0xe132c0454bb78a65ull, 0x6547f9066a8c252full, 0x739b7c507c4e28deull, 0xa15e669a4f3941e9ull, 0x303a0aaaf902867dull, 0x8ec1c09d80cff06bull, 0xcd4676c249cf88f1ull, 0x24906159b9b49f7eull, 0x4e0ec2bdcc67e79eull, 0xf871994c4414362eull, 0xaf080c6ae8679b5eull, 0x9a9dce6f49772d41ull, 0xd64be110529e337bull, 0xfcd3049c81d43f13ull, 0x88a93a94559d0604ull, 0xa629e3da8d5a444eull, 0x16c2cf38e43f670bull, 0x1f67a5542e444e08ull, 0xb425cfbe39f79675ull, 0xfb16da7d5f3b23fdull, 0x6cd8c1d281ce571dull, 0x37877c5c32b84101ull, 0xc0c7056562a4ec4ull, 0xc518c8439166cc69ull, 0xeccd7248ba777dfdull, 0x1daf6e42fc8f0c3eull, 0x49cbfe55fb0cc06full, 0xddfc83a06b633121ull, 0x50f451977276c8cfull, 0xb9da2fd7168a5161ull, 0x409e618d88752379ull, 0x423234e45b4983bcull, 0x1c40da0d33cb92b9ull, 0x6e4a1610fc01fd6cull, 0x55591f05db5808c2ull, 0xea011492b47876aull, 0x956c0890b7cc79f1ull, 0x45f3f26521c51c1cull, 0xa04b7139a33c2eccull, 0xd708a0932264e6ddull, 0x4feb20c25301a5f4ull, 0x5c04deadf09538aeull, 0x1f55ad004088ff36ull, 0x7501f58057f1f693ull, 0xa534c68d50d0eb4eull, 0x785a01b5717ff62ull, 0x6daffe5195888d16ull, 0x995094c9d8673fb3ull, 0xef0422740a1eee97ull, 0x299faae308863301ull, 0x2a6cacc756540a5eull, 0x63db82d5148203c5ull, 0xbe31f762fe51af14ull, 0x1c665ee0cde621d7ull, 0xd26b03873e165ac2ull, 0x89f4e57ef25f75e7ull, 0x7113a586199f4846ull, 0xe26bf91a3a942fdfull, 0x8edf764078cc0b21ull, 0x457b8d3624a0398dull, 0xa88922fe594d67dfull, 0x3836f4adb0d370ccull, 0x81f2bd6860ec1109ull, 0x4eda6b1b09534d7bull, 0x538966709ee1fc63ull, 0x352d59a3c637c1b6ull, 0xbcf99a1b4d71cb58ull, 0x7df9ba673d0b530dull, 0x3505017923c3a6f5ull, 0x13235f09ffa6c730ull, 0x3381e625c738ca15ull, 0x56d4f5e8d7a2d116ull, 0xd31a5ca84fcf3638ull, 0xd1881f5f85d6d3e2ull, 0x4052664a3472a4edull, 0xa65d7b3fdf76e227ull, 0xae7dd9b077413131ull, 0xe6e5eafb72fadbf6ull, 0x956ade15b950fe5bull, 0xce57618dca878435ull, 0x36c4ab843df35a0aull, 0x6909e33616b88560ull, 0xdd848d2634e86b03ull, 0x9aedfaf3389ea12aull, 0x9897a0af16d2051full, 0x8afd8617e1104a4eull, 0x262686eb282a4220ull, 0x10bc299bd4edac0bull, 0xf683f8150ba9388aull, 0xa0b92680adccdb0eull, 0xd3b251457161f10aull, 0x15c90044c403cffeull, 0xf396f9c619390b67ull, 0x99928bbe25a95086ull, 0x927f4d25eb3e8607ull, 0x751f1ce27d902aeull, 0xa06de10444101628ull, 0x9742d4ff308017b5ull, 0x1dcfb457130b8724ull, 0x9bea7161d32cd659ull, 0xa3b69d6c967d956aull, 0x2fdf5418620a1ce4ull, 0xd68590adc2db2e6aull, 0x36a0dfea5d41bd14ull, 0xd60739779f1aa4cdull, 0x2cc991076d62bc5ull, 0x5bd530928314b08bull, 0x35b1b2bd56f6c770ull, 0xfcffc1b2939e7caull, 0xb742c83715f36cdeull, 0xdac5bee74886a14aull, 0xe3f25d4ba348d697ull, 0x8d4cf48d429e3da3ull, 0x5a165268e4d75642ull, 0xfb921163f9185034ull, 0xf390df263684b77cull, 0x6c0ceab3ce9d9aa7ull, 0x4743230c24dc9aeull, 0xb2ed64266c2ad20bull, 0x37ef84c5521a66c4ull, 0xe954de377501bd52ull, 0xa8a7843b2fadd675ull, 0xd4932218d4c5049aull, 0xb8b18057e5fc3329ull, 0xdc2d9df80b591337ull, 0xe86b4d539d561a6cull, 0x2cfe7f8fdccffefdull, 0x94636f774d7fa166ull, 0x9891fe1d1f1b0fdfull, 0x5a705ab0498bf273ull, 0xe1ec31b10cd0c97eull, 0x4af491be33a73004ull, 0x9cf7562c567c2cdeull, 0xb71e5e34643234b6ull, 0xd59a25978ee70a70ull, 0x91b83bd9cef1a8ebull, 0x8e23abfc99ba1f3bull, 0xae81566246b0ef8cull, 0xf9b40b0dcbf8add4ull, 0x4359931e54f641b3ull, 0x2a70181048ca59ddull, 0xdfb0a110321ea23dull, 0x77dadb831a10c44ull, 0xbefbe005a98af1f8ull, 0xb524685c4610d683ull, 0x71bd264844907bb9ull, 0x43c398fdfc9b1edeull, 0xee3991b8ad3e540cull, 0xfe295ff17eaa0f43ull, 0x85c4b7c60bd58a4dull, 0xb9d227a72e9c9d7aull, 0xe986770993328e9full, 0xebf0cf3ee2b75692ull, 0x6bf568d6c3041c8cull, 0x33e1d6d516d2edaaull, 0xccc93286a94e8043ull, 0x8dcee152168a272dull, 0x10d5b2d27af120cull, 0xd4f56cb099d62b09ull, 0x871a36fa79856c20ull, 0xdc69c3bef15242deull, 0x256b7d671d35d318ull, 0x6903e7f2a1bcf568ull, 0x196d37131b47239full, 0xeb4606d4b5407654ull, 0xb64dd1fa4b07afd4ull, 0xddaaf546fc89f805ull, 0x37d74eb61f0789daull, 0x97228ced784e90e7ull, 0x6e1e1230787690e9ull, 0x3b0f516dc9d625f3ull, 0x7ccef39eadb27d3dull, 0x83a0c13268f81d0dull, 0xfae556787440ae13ull, 0x77cfc8f1ae6df97cull, 0x8d1aeabdf46f4fd7ull, 0x8ea39c25251ddf28ull, 0x5a2e88dd626026d2ull, 0x6b23ab5e8e1da3a6ull, 0xbbca2f159d1c3668ull, 0x936c9ea7bc030741ull, 0x7c7a28e88fa0e180ull, 0x8845ad7872ceb1e8ull, 0x5cda6fef4080dde2ull, 0xf54a6466367e9c59ull, 0x2edcf362e04bd392ull, 0xa24d79cd7c3268ccull, 0xe85bc7d2834a1a36ull, 0x94a5a4c7da394d19ull, 0xa19eb7de79a3d66dull, 0x827b1d495d7f3fcbull, 0xa9344a7642604ab8ull, 0x9c2f55cf9083fcadull, 0x478df657c3002a74ull, 0x6bc1089a6b854272ull, 0x66327490c5ac6f43ull, 0xa51484ddf8cb18e8ull, 0xe314debd22a2c716ull, 0x12ec7f116f93209aull, 0x1b19205ebb67d45ull, 0xe8856070121e4a8aull, 0xfdb4df0a4a002434ull, 0x77653761ab94fd84ull, 0x725666a8b96a1cc8ull, 0x63c5dc352fb72668ull, 0x1321d9dac38055b3ull, 0xf469eb1ce0b31016ull, 0x31125035945277full, 0xce850c2ea48d143cull, 0x2c50eab5be1b778dull, 0x86a7804d37970ca4ull, 0xb0ef74cc85c82779ull, 0xbf70a4bfce416b25ull, 0x67791dfd26fc610bull, 0x329cdfcc49af988full, 0x874c6066524cb07dull, 0x4a9af1a691ba71e3ull, 0x93882119cdd0a740ull, 0x86df72fced024460ull, 0xb58cff7492d58211ull, 0x3eae314f73e30ec8ull, 0xe487632f6155fdfull, 0x98570da1f47bb5aaull, 0xba998a6549b97c14ull, 0x3ba39c190109f1e6ull, 0x15d7ce2563c978b2ull, 0x1ca6dbeec14ec639ull, 0xdc816c44342224f0ull, 0x391919b1a47d2d8dull, 0x155d6f6387668a13ull, 0xf8853ebc47114bb7ull, 0xde9bea391d19c766ull, 0x93dc3d55b51ac037ull, 0x9b48ba25a9a6a33eull, 0x7ff5d059cfde7f47ull, 0xa6e76cf4e3c67fc5ull, 0x8bec81bc41e510b8ull, 0x2ddff86dfdc0f904ull, 0xcef310da57bd363aull, 0x644e7e28c471853aull, 0x685c82b19c1b9144ull, 0x7e849536841d1115ull
};

uint64_t f(uint64_t x) {
    x ^= x << 13;
    x ^= x >> 7;
    x ^= x << 17;
    x *= 16594695088224831727ull;
    return x;
}

uint64_t verify(uint32_t round_num, uint64_t codeword) {

    uint64_t state = 12695138433207793711ull;
    uint64_t secret = codeword;

    uint8_t* y = (uint8_t*)&secret;
    state = f(state + y[0]);
    state *= 11270227205698291177ull;
    state = f(state + y[1]);
    state = f(state + y[2]);
    state *= 11270227205698291177ull;
    state = f(state + y[3]);
    state = f(state + (round_num & 0xFF));
    state = f(state + y[4]);
    state = f(state + y[5]);
    state *= 11270227205698291177ull;
    state = f(state + y[6]);
    state = f(state + y[7]);

    for (int i = 0; i < 35; i++) {
        state = f(state);
    }

    uint64_t ret = 0;
    for (int i = 0; i < 8; i++) {
        state = f(state);
        ret *= 0x100;
        ret += state & 0xFF;
    }

    return ret == hashes[round_num % 256];

}
