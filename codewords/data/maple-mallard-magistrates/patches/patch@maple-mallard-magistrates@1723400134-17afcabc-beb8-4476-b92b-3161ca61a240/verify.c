
#include <stdint.h>

uint64_t hashes[] = {
    0xe9c2237cd8cdf67cull, 0x805a338b7f72fde1ull, 0xff589986dab74cf4ull, 0x57d6565d73ac5746ull, 0x820220ffa940860aull, 0xa81c5aea89f1cf61ull, 0x26663faff935ce13ull, 0x1c04f29779361d54ull, 0xe8bef512b2ca9d2eull, 0x1e1d66b6c4c5bafdull, 0xf08a406e5206adadull, 0xec8a01bb45183641ull, 0xd66bd7219d10e624ull, 0x9c665ed816e68032ull, 0xf2fb47b1107e98cdull, 0xac7f1fda8e78eaeull, 0xdd1e3a07a97f4f3full, 0xabf8bb9dd13aa546ull, 0x227d7f02a24ad1baull, 0x8f7c9a53d1cdcef2ull, 0xe084d8d12024f3ecull, 0x6d909562a5a8467aull, 0x5464e09acb381decull, 0x622f579f4197b399ull, 0x2219fe9f61c758ccull, 0x3b04cc92edd60130ull, 0x108e42f032af4fc2ull, 0x6f0ef3c860f6e8d7ull, 0x7be67474743c6d9dull, 0x6f7ed0af527b7f8bull, 0xf8df47064d5c872bull, 0xec825191c00d124ull, 0x2ca3928b5fded059ull, 0xe4e159692b23011eull, 0xa10532084ab63845ull, 0x8a35797b6917c70aull, 0xe3badb8ecf85d722ull, 0xb39af98af99a525dull, 0x86950532e2910c8dull, 0x429b66699999b865ull, 0x4857d913e02be181ull, 0x97f9ce1bdb0504ebull, 0x846e90f68dc7a840ull, 0x1160101784edef07ull, 0x43067cb8be780027ull, 0xe7bb0b55a24e289bull, 0x8bbd537851c69c38ull, 0xfdd16688a8f0839cull, 0x835815dc02908cb7ull, 0xcd3e6559f0685e79ull, 0x6b08f0c8e13d0be1ull, 0x130ba988e9f0fa72ull, 0x7b5e505368707191ull, 0xab9670141e2e4d91ull, 0x3e1e2e0b24e47afull, 0x4a66cd8592847831ull, 0x1445929fbc01630eull, 0x1796e1552a2c78b0ull, 0x285cdaf6f2ca8f76ull, 0x74b6b4042c899307ull, 0xca7cbb90833db02bull, 0x12e7c2a016b4b245ull, 0x103703625deff4full, 0xe0f40eac8e61dc3aull, 0xbf918eebe66ed9b4ull, 0xd3167cf1a5e30caull, 0x83123b741ade355eull, 0x313325957313c166ull, 0x56b640284064b965ull, 0xe7009394d6a337afull, 0xb379f6d9ad2963eaull, 0xb79e76fb953d7bbfull, 0x3e2ebe690d161113ull, 0x3cd3e490d3be8948ull, 0xdf60799154680ce4ull, 0x8052df2fbddcacd4ull, 0xe7e8c123c590b50dull, 0x9408686f06d8c689ull, 0x50222e01afdd0b6dull, 0x2b5f21ec0613337cull, 0x10f1b636d0cef780ull, 0x1b39c57e6d583fd7ull, 0xc5378d6766e0710full, 0xfb0fe496e970fdbfull, 0x3a544d5e1cd77c2bull, 0x8ea04fbfa9c731afull, 0x2e37d94b978e099cull, 0xfbf2365442f8646bull, 0x4678c21e43a9d665ull, 0x65171e5baab12068ull, 0xee09f7826834dab9ull, 0xc6df85d3e0d1cddbull, 0x6a29c10f9fe63564ull, 0xd05a7d01b9361113ull, 0xbc549cfd725c5037ull, 0x6e68f7c656ef0d80ull, 0x130a0b340f1686fbull, 0xa083ba4afd53341full, 0xdfe9235fe80482efull, 0xc7ef3cf533e62e4aull, 0x6c3109ebe42e018dull, 0xf5ab07991f49cd41ull, 0xc282fe1594ebe77ull, 0x427e0e7acb785f9bull, 0x128289b15d2286b8ull, 0xbf77b9e26142d1a8ull, 0xff976569abae1d25ull, 0x396e211052914291ull, 0x7578345369ea3a3dull, 0x8664a300d723a1e0ull, 0xee7e8415c4617e41ull, 0xd9c3b92947d70350ull, 0x50daa6fb7a8783c2ull, 0x829bbe166c5900efull, 0x29ed184c6bb2129aull, 0x4fd2802c427785cull, 0xa1b2ba8e8a07ea7bull, 0xde5140c287b97943ull, 0x6619c2e94558220dull, 0xc012791bfc64f211ull, 0x53a94cb7fa56151ull, 0xe9829b59b4684d76ull, 0x74ddacefa1153623ull, 0x4d3ee6268f4bb289ull, 0x4533978ad575e1b6ull, 0x9e843d2b3e1a3ec5ull, 0x319070800fe4c891ull, 0x52b5a8b8eecebabbull, 0xa64bb4f6a9ae9964ull, 0x7a8ef7d2d5cbc9e9ull, 0xca49ddaf60e935a4ull, 0xd5a2e7c78984110dull, 0x264cd4ceb5a3bed5ull, 0x6e2ccd3302ddf40aull, 0x7c801f3fa6eecd51ull, 0x8756fbd5d118849cull, 0xaee8c19dae433d01ull, 0xd45e31dd67b4050aull, 0x7f5b58badfdd82a5ull, 0xcf12c57d4c0af86bull, 0xdb26570a4619d0dcull, 0x910c54e7692d4fe6ull, 0x188b82bd3bf9c519ull, 0x909f42ca084406ffull, 0x209eee42a8b063faull, 0x44c53ddb51dc2107ull, 0x9a0b2d3bb26a01deull, 0x1d2ad22f8b1a9ccbull, 0xcbf8e70c7608d284ull, 0xb71f4b34f5ac4d74ull, 0xdc85a6d512ad008aull, 0x4a07cca3f66e87fbull, 0x6bf2855865886694ull, 0x1d183b07b3bf3757ull, 0xee78eeaf76b15c34ull, 0x545a11f2db1961c1ull, 0xc3ff5a413a8153e6ull, 0x1034c78e526cc10aull, 0x731c49b006a04ca1ull, 0x445632ad05189053ull, 0xf0a0161a78e9fd33ull, 0x39142647cd469446ull, 0x43aefdc6506baa3ull, 0xa0593e8e8e9e41b5ull, 0xebe07e47b342e87dull, 0xaa8938514fe8a367ull, 0x1f29608dcd4a1839ull, 0x41e01f9f21c9d179ull, 0x568d2f88cda21146ull, 0x553f65be284abe16ull, 0xe802dd99a66ed0a8ull, 0x9647e1487661fc51ull, 0xa3a4c2e63f7e6ef8ull, 0x412845b3ecf7715cull, 0xb0bcd6ffee9be73dull, 0xe4eede08057972fcull, 0x2c04273bc0e6dd65ull, 0xdf2cf1ef3088f47dull, 0x36158c7c41325c2full, 0xbd1eddf482992087ull, 0x4ad798ef7b87f559ull, 0x9ea948441af29352ull, 0x4befd65bb179be9bull, 0x390cc0285316619aull, 0x30e94732a69fd85ull, 0xe5009266df0db00cull, 0x3c32ce39b9c4f6b9ull, 0x780a2b1e5e875445ull, 0x8cfccc49a0c55131ull, 0xcae26040b50af35eull, 0xd750703038f02b0eull, 0x7a292533c8a71defull, 0xaae042da054e9edull, 0xa6c512cff8de44a7ull, 0xd69e9250dfcf9179ull, 0x715926db2215fcfdull, 0x4994668f916c027ull, 0xa54b3bb161a22c8ull, 0xfc627b776e31c2a0ull, 0x748a31a7ba701cc3ull, 0xbba946fefcdc95b5ull, 0x9d59d1a6aceacfddull, 0x18d6c48f73be836cull, 0x864c934b336fe97cull, 0x3a8b715e386ca156ull, 0x117e21466692db72ull, 0x3325061c1c18c6c5ull, 0x6a0ddc2345eb0c55ull, 0x78a0b2078b3eb857ull, 0xe96900dc292bf417ull, 0x60714b65c3b27034ull, 0xd53f8bd7a3c5f96ull, 0x14fa552bc2c4fc80ull, 0x5e7d9d67ff4027a1ull, 0x29a6817c76818c03ull, 0xb38be7ad4b53469aull, 0xce86c08677dce94ull, 0xc077213707332f37ull, 0xff83676a3d98819eull, 0x4296a778e765c49aull, 0xbc6f412a506453cull, 0x68b0b38fd0e8c05bull, 0x82b1b7daa487d719ull, 0x8570598b32c9371dull, 0x7de391462b7d00f0ull, 0xea529f2e40b3945full, 0xbdd6359123fb69bcull, 0xade781cbed6471e2ull, 0xc271e012aa862144ull, 0x5bba8ee3731e8a1cull, 0xff7aa18bbc925a07ull, 0x9b3310d7a972ba6dull, 0x15dbe6afb5ce5eefull, 0xbb1cc96f908f1b09ull, 0x319ad633a2c0233aull, 0xe4e0b3f76d48cfa8ull, 0x40b50afa947ddb04ull, 0x8c502dd3cd19428eull, 0x37b4257b18e0e1c0ull, 0x873aee72a456bf76ull, 0x1fd121a77806d461ull, 0x85134498da30b44cull, 0xc53cca2161d257c2ull, 0xae177ee20c08bb65ull, 0xf289d8026b1597ecull, 0x7c0bd7f1e442b2aull, 0xdee0a32b16d68eccull, 0xc693f7cb45565281ull, 0x683092cfb5d46938ull, 0x27baaca4e1a052eaull, 0x7cbab5b015e40624ull, 0x33edd2e41b29fe03ull, 0x807b9dd0ee662bfeull, 0xcc4c56393b5d00e6ull, 0x1d9beb62abbb8a27ull, 0xebd0df6e2a6a0317ull
};

uint64_t f(uint64_t x) {
    x ^= x << 13;
    x ^= x >> 7;
    x ^= x << 17;
    x *= 9654333775429308587ull;
    return x;
}

uint64_t verify(uint32_t round_num, uint64_t codeword) {

    uint64_t state = 11181845483340761519ull;
    uint64_t secret = codeword;

    uint8_t* y = (uint8_t*)&secret;
    state = f(state + y[0]);
    state *= 16055033113631213671ull;
    state = f(state + y[1]);
    state = f(state + y[2]);
    state *= 16055033113631213671ull;
    state = f(state + y[3]);
    state = f(state + (round_num & 0xFF));
    state = f(state + y[4]);
    state = f(state + y[5]);
    state *= 16055033113631213671ull;
    state = f(state + y[6]);
    state = f(state + y[7]);

    for (int i = 0; i < 32; i++) {
        state = f(state);
    }

    uint64_t ret = 0;
    for (int i = 0; i < 8; i++) {
        state = f(state);
        ret *= 0x100;
        ret += state & 0xFF;
    }
    ret ^= secret;

    return ret == hashes[round_num % 256];

}
