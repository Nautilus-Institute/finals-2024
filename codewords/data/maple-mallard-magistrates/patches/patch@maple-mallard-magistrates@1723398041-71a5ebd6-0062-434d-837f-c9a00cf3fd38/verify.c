
#include <stdint.h>

uint64_t hashes[] = {
    0x1dc72accd3eed32aull, 0x8bcac9a65b9fea91ull, 0x30c4cb52e421dd74ull, 0xea5fb5c401ed5cc8ull, 0x43551f930c548097ull, 0x685214428893fad1ull, 0x945b9d1ceeebec15ull, 0x60c673254b2fd114ull, 0x2b2b6dd54cd6b7d4ull, 0x83ac0917ab2c0622ull, 0x138f001a060a027cull, 0x1a5c90d3223cb865ull, 0xfa116117a5000414ull, 0x1941c9621aee1d13ull, 0x7bf7ba3f039d5090ull, 0x5e2c40b835ff3232ull, 0x6c80d5dc03bfc897ull, 0x9d4c48ce376741fbull, 0xfc3db5d039d18093ull, 0x728aa1a6e56c88f5ull, 0xc51eec8794512dedull, 0xe68fb0a9281058e4ull, 0x8c93943bf98495a2ull, 0xd62f717701ed820dull, 0x3e2a2a3a0644d2bbull, 0x2a508605e92816c6ull, 0x7361d5e223e95e40ull, 0xcb3014149e45cd38ull, 0x7f95fcb3808d2c12ull, 0x51273f49b9d4fb78ull, 0x8b4a8ea702e8e544ull, 0x6963e3e4fd1abe65ull, 0xdcd97c4c1cbedb30ull, 0xf23bd1783a3c6e58ull, 0x1db4ae2d17cbaefull, 0x23291d3fa3c6671bull, 0x9ea7dca57e8ec934ull, 0xb12ee45317e11870ull, 0xd51e2a609a9d48ceull, 0x80ef741eaa19f154ull, 0xde0d573b5353158dull, 0x9a2d8b82db4e7c24ull, 0x9714f69d866b798dull, 0x258a2915894476dull, 0x73edce9926a60371ull, 0x4ce28bc61d71955eull, 0x2e3a50be53672587ull, 0x178b50ca45e7eeadull, 0x52ee4365ef02da25ull, 0x3b274dc14c46d851ull, 0x230f859eab9a658bull, 0xf168f20f670d292dull, 0xd95848f0e5800bddull, 0xd96c7a7c6842e2ebull, 0xa9ef90ec0bf8843ull, 0x54bc6193c6fd8a17ull, 0x24b8b13062ae81deull, 0xf75e6a58766a2c04ull, 0x89309ed9b011996cull, 0x62c62f252f2741e5ull, 0x56d93b259a1fa77ull, 0x6fbdbc3f2925f578ull, 0x808bb8d152c25161ull, 0xf324b277b9a43b17ull, 0x1f455115d90c2c16ull, 0x1c76e0198302ae29ull, 0xcf3c02f2a750d86full, 0xa083b60b8d6438b6ull, 0x52a4211b5d69657dull, 0xb5b0e9f45dcb4014ull, 0xc750f86553675f81ull, 0xa3eae31ec8299906ull, 0x4a2d350e6638114ull, 0x171d2b2f518be0bdull, 0xb24ded6220fa31dfull, 0xecbf4e1070a0a746ull, 0xabf479d51042f6d3ull, 0x9e75d73c82b9a255ull, 0x446668f209e74ac8ull, 0x662e3a044e1a2480ull, 0xfc71a9f86ff35ee0ull, 0xcc6b651d39b366c4ull, 0x17551b7b0d599f52ull, 0x8fa05f932ac3d09ull, 0xba69fb34f2fb5e78ull, 0x4224f2796119e192ull, 0x11b58c69d1dc7dbdull, 0x482a280e985fbbd8ull, 0xcdfc5f933c96298bull, 0x664eb4a716c6f546ull, 0x7b81881dd94a8c11ull, 0x68d4f390ef7608beull, 0x1c807fa97e50f4a5ull, 0x3773a7422cc0d1deull, 0xdeb723a801369dbull, 0xa556c627572d313full, 0xd6ef5af675730f6full, 0x1ef499502c2c24deull, 0xc84f3971215935c5ull, 0x3f676bc19699a041ull, 0xa213ab8c5f55ff9eull, 0x875044843f79df1cull, 0x28ce3d0b7dfd6690ull, 0x5e5646c48336f89dull, 0xf15c6444820f5f33ull, 0x93aef7cadf44b801ull, 0x19d9e0ff62eebd7aull, 0x963bf97ac47f537dull, 0xda09b1ca796d498bull, 0x831cf46d1baf0878ull, 0x4b8d86237f87be41ull, 0xd601539b045afa9bull, 0xbdc099d4d78c4757ull, 0x3eb203dd9a4df3d8ull, 0xeaf176f645711103ull, 0x40c86d438960d283ull, 0x6f6b23f5b807b1daull, 0xf9dad5d495d8cf82ull, 0x6bebeecb1eacc9b2ull, 0xe841457d2babf8a7ull, 0x778facdb84db44caull, 0x6e40b82b4bf1421aull, 0xf7d43a51cb4c9caull, 0x5f55ef4ada95e03full, 0xbe9bf8b9c60ff5e2ull, 0x7179d394c7b05389ull, 0x91722290d716483eull, 0xf60353f1be1161ebull, 0x29e1ae7f313f6347ull, 0xd3a6915a34a0d930ull, 0xf8679faa731b4f03ull, 0x4f2e5aabb6efce1ull, 0xc560f2a772840fa7ull, 0xee47ff6c06d4f70eull, 0x44149e0f8d247228ull, 0xbfae0dd30e7a32ecull, 0xf255511d63632329ull, 0x11ef14bce5280834ull, 0x13e734b245ad64d8ull, 0xa087d6252501f36cull, 0xd0f386f3ac272full, 0x38f2a772003e3832ull, 0x12b2b7e8c17820b4ull, 0x6b03f37660fabff0ull, 0xddde07599f9089a6ull, 0xb0671f7ffdfefddaull, 0xa1608ca118f43b5full, 0xa1f04dc3d64bc362ull, 0x19c1d085b42f093bull, 0x3e54baad96a38e49ull, 0x4acacb862309eb24ull, 0xd2e93e367c6adaa5ull, 0x81647892f3d88370ull, 0xc8a55cc4975ce2ffull, 0xf1f15cfb6a3fc13ull, 0xaa71632b75716d5dull, 0x762c98453f8d7200ull, 0x156dbd66f85571f7ull, 0x33716dc9ae3b83acull, 0x8fa6292bd124fe27ull, 0x44d0578b1624ae7bull, 0x2f1d4dc1aa13bb94ull, 0x858457c786515f57ull, 0xa26157c54e94b358ull, 0xf0fba2677db51c88ull, 0xd504822f19f978caull, 0x1a421e5c729ebd20ull, 0xa1360872a45165ddull, 0x6cf6e91aee0d1b37ull, 0xecfb643c604a2e7aull, 0x734dc358d08f262eull, 0xd29b8a5599a837dbull, 0xee13a3e0930e9e0dull, 0xa43de716a2af1c7aull, 0x93383e86a5a0d168ull, 0x253f294b05437b01ull, 0xb8c3367eb603c97cull, 0x905f3f350f59cfd4ull, 0x56d0f180393b65afull, 0xd2356d8706dced86ull, 0xd16862202c7a9071ull, 0x2af82dfb7a16e49dull, 0xdd60aa813ad2c380ull, 0xaf1002d21d6b3f7dull, 0x47f9bc49518d18a4ull, 0x6e383ce60379aba2ull, 0xb05581686c4c6a3aull, 0xe21beba847430bc7ull, 0xf976c4828aef97cull, 0x9acf96f71048b217ull, 0xf0f87d217274351ull, 0x18a073b12202be17ull, 0x59d9420452ea273dull, 0xef20fce5d26b0d8full, 0x435bad98758fe407ull, 0xe5ce199902de4325ull, 0xeba00fbb4ef6cfa4ull, 0xfee5e0dbea97406cull, 0xa3506a80e700ea07ull, 0x38f83d751dd514beull, 0x93b49170e0fbcef3ull, 0x98bbbc4521c1ac43ull, 0xa7485a5c34fa7f1bull, 0xba8f3e901dd17a3eull, 0x44ec05bf9413d9b0ull, 0xdd024c0e3c1c5e6eull, 0x50005e402464aca5ull, 0x658398395119190full, 0xc3b8c5d699c2d9deull, 0x61439db221d39403ull, 0x5634cc0d532dfdc2ull, 0xfdf28d74fa41734dull, 0x58fcab538943951ull, 0xf887d035edf0a5f8ull, 0xc306cbca3f0b794ull, 0x7854d661e7a27763ull, 0x206700a2ed44719ull, 0x427afcf502fe0bbdull, 0x76c0affc63039f2aull, 0xfe49df4402521efaull, 0xe8e2325a5ba6109ull, 0x82670d7997969b14ull, 0x2be350f03febd8e1ull, 0xd63d9ffc9d78c41dull, 0xf0a7c685a401e544ull, 0xff14acf9127e6cd8ull, 0x88494f65f144ea31ull, 0x3e76e4a7aab39403ull, 0x9992f7e2e1c2a122ull, 0x414b99bc05c3f6cfull, 0x81a6119b32b4b3fcull, 0xa00fe9fc6851a72ull, 0x28b03b2ba916c6c7ull, 0x74fe61734b794d45ull, 0xca1b0b95ec01cb78ull, 0xe89302ceeb1af439ull, 0x2ee23153545f73aull, 0x582cac7703a97066ull, 0xa84d5381083cfa95ull, 0x57f2fe5d4c9ac9bull, 0x232d254359479724ull, 0x1244824d0d194d81ull, 0xd2ed7cae7783fea5ull, 0xd673a5aeb7da37c7ull, 0x6bfde0e1507292e3ull, 0xa47539d5ea9feeddull, 0x3c6632cc75570d6full, 0xb9c01d49f92aa09dull, 0x136bd97878aaab6aull, 0x79bbf82b957888a5ull, 0xfa7581e82fa13e86ull, 0x37593defea5b23a1ull, 0x6b2d9142202581eull, 0xd3b850c08ca970aull, 0x3151a72c48447c82ull, 0x39ffea11adde451full
};

uint64_t f(uint64_t x) {
    x ^= x << 13;
    x ^= x >> 7;
    x ^= x << 17;
    x *= 11567574099635665273ull;
    return x;
}

uint64_t verify(uint32_t round_num, uint64_t codeword) {

    uint64_t state = 16685063925786091877ull;
    uint64_t secret = codeword;

    uint8_t* y = (uint8_t*)&secret;
    state = f(state + y[0]);
    state *= 12698043015905283343ull;
    state = f(state + y[1]);
    state = f(state + y[2]);
    state *= 12698043015905283343ull;
    state = f(state + y[3]);
    state = f(state + (round_num & 0xFF));
    state = f(state + y[4]);
    state = f(state + y[5]);
    state *= 12698043015905283343ull;
    state = f(state + y[6]);
    state = f(state + y[7]);

    for (int i = 0; i < 35; i++) {
        state = f(state);
    }

    uint64_t ret = 0;
    for (int i = 0; i < 8; i++) {
        state = f(state);
        ret *= 0x100;
        ret += state & 0xFF;
    }

    return ret == hashes[round_num % 256];

}
