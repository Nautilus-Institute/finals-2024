
#include <stdint.h>

uint64_t hashes[] = {
    0x3fa5baa9ae510fedull, 0xa67df380333f3945ull, 0x775dcd0e82cbe415ull, 0x879e4def66727296ull, 0xd13cbe99ae2d3745ull, 0x9950da9b9e73dde2ull, 0xaf34f03b45d53638ull, 0xd261531795be1d8full, 0xd4fd9433d94c26c0ull, 0x5fd31c58f8831472ull, 0x869188e7000ce251ull, 0x8835d9d67b55fb36ull, 0xe6c1c48322780a88ull, 0x3fc79609a974729aull, 0xd477b3e6159f7836ull, 0x4f3b99340840fad9ull, 0x1a55ef40b1f2f0bull, 0x3c064aec81466afcull, 0x5e62d05d230d1717ull, 0xa2f938ae174d05c9ull, 0xda93fe3d95463e3aull, 0xb1ba5f0c19ea3d6ull, 0x1363cb8a3b7b7153ull, 0xfd9e41ff98afbeddull, 0x5280d5e0b784c12aull, 0xbea3b0a5b073db78ull, 0xf2dfb091e8636185ull, 0x90d18a61f96e66daull, 0x4fc52e444edc0bc1ull, 0xcc19afac4bc3468eull, 0xf3b801c9aaafa80full, 0x8879af206098b542ull, 0x17593e43feff0cbull, 0x6204b825d74aa2cdull, 0xe7f2a934b2d78221ull, 0x3ae04b034589a0e5ull, 0x3e6c5eaacd1230b4ull, 0x94cd2aec1f9f0c30ull, 0x1995428acfbe2b63ull, 0x35898ab5729edd5eull, 0x19392ddb5cc83345ull, 0xdac94a92c122969full, 0x313fb91c0252c497ull, 0xda3b334dd7540878ull, 0x3d838eb74c422222ull, 0x675fb368e6bfd6a1ull, 0x62daa142680ccaull, 0x6959d9983f1f41fbull, 0x9a0ff7fe533d67b9ull, 0xc15e12aadf3cdc6dull, 0xc7e88b2ca86bed24ull, 0xbc3dc0987aa550bull, 0x74b2f5766ebca1eaull, 0x455fed0c782ef639ull, 0x854c30cc799db86dull, 0x751d5157590b19f9ull, 0x954cf4b160229cfbull, 0x29218d20801b7de5ull, 0xa0e90e2c62963d91ull, 0x8a1915e36a90ffe4ull, 0xeed1aa99623012d8ull, 0x358bd69358f865b5ull, 0x9a13a1fecf2a3c58ull, 0x225452be0feb2a22ull, 0x297be76c62f6a7e0ull, 0xe7f81d8d06f8d52cull, 0xe7665cdcd9986bdfull, 0x24b23b45dfeed78cull, 0xa562067490bd9831ull, 0x7195246c3886b9e0ull, 0x484210dcfffc27d1ull, 0x9e819c436f4fe398ull, 0xa429d1326cc243dbull, 0x77ef6c0ec6f19055ull, 0x303a347002ec5927ull, 0xecc962a861c78ef5ull, 0xf98e0781848d124aull, 0xb55afe279c986c5ull, 0xd22b293fb9e6736bull, 0x3a78bc338fb637c7ull, 0x3a74a567ec24921ull, 0x82339f0cbc6f4599ull, 0x768441dbaa2397d8ull, 0xaca76660203e94cbull, 0x4f0349776bdb2aeaull, 0xff060e64e685a273ull, 0xede4294b3bd36832ull, 0x8108d6b13e303cdaull, 0xc2a54ed84d01bba0ull, 0xe8470d6319393fdfull, 0x99642e022c0a4a34ull, 0x62ecb57cf8f5c837ull, 0xcf09554a63539e9ull, 0x1503d176faafa6c3ull, 0xa714cae1b433397bull, 0x40c87f2595c41583ull, 0xc17488850cf47d1dull, 0x82977a8279f9a609ull, 0xee6b9dee87a4990eull, 0xbd1282e778123a7eull, 0x6bb1e4e34e2eea97ull, 0x49e1e691e6af06f0ull, 0xb61b91889994f72aull, 0x557f69b1fa71bb1eull, 0x130111a58e63d9ceull, 0x3c3a2c925bffe873ull, 0x9d70f6adb86f1f53ull, 0x8a5553b732c29d78ull, 0xd08976a6e1f41713ull, 0x57f522d05fe98ce7ull, 0x9f86819a2b65e3bcull, 0xd56a3a1a2ebc7b71ull, 0xa631875c34d08312ull, 0x906f2fa39e0b39b3ull, 0xbd5e48e8790d2de5ull, 0xf780b5e857f3f425ull, 0x5e3b28dd4abf22full, 0x4bedca955c62204aull, 0x2d83021e148ee5a8ull, 0x1131cb1a7e68b4b1ull, 0xc1c8876430f43f17ull, 0x3e5eae15ffcec9b0ull, 0x17ed4640fe7f8128ull, 0xe891fecd202e5aa0ull, 0xf384973aca798d10ull, 0xac55c30e88492d29ull, 0x9ef223e00a8c12cull, 0xf42fb332d0d33224ull, 0x462d0b17e386c1aull, 0x8c27a158fe7ff97eull, 0xf5cad760d45ba910ull, 0x5b8f4cb0f322a473ull, 0xfc433def9a7fdbf2ull, 0x192d6f6183b8e388ull, 0xa142e8a9028addbcull, 0x3ad9a9f7a6cf645ull, 0x35298fa47f0f2315ull, 0x69c9b063cb3cd8d1ull, 0x3f3595b217ad66b2ull, 0x3dab9e499f22dcd5ull, 0xdba009d3b837eb06ull, 0xebbcb32e86c7b88dull, 0x8988adcc195b5f69ull, 0x28cc411f5b8fb8cfull, 0x2ba160ca5919dfd0ull, 0x2913e364009cab92ull, 0xf5d2afd281b04729ull, 0xba833c8e05af903full, 0xea27c9fae76a60e8ull, 0x1bdf34e6c124fefdull, 0xd1b8abbccb9ead9aull, 0x4060ae8f3828d0cull, 0xe1241abef1c06f83ull, 0xb6b1b31a3a60f25ull, 0x745e10a6bbb24db9ull, 0x496b29a3b82541d5ull, 0x930a98eb0ccc9502ull, 0xe8cbda9b420484e5ull, 0xb476f29bf926325ull, 0x1b13034f37d56e58ull, 0x57df4aec2fd5aaa3ull, 0x9d084e70d84b1f9bull, 0x3303e12890e12a10ull, 0x5abc233bab4e042eull, 0x5b33cbb877892ab2ull, 0x32b23d5f0bab7c06ull, 0xbe83c2cde0a3ec69ull, 0x4cbc9f8cad6e6a6aull, 0xae356139e946ae57ull, 0xe58e4d11798196b7ull, 0xc522ea453bd7fea5ull, 0x3276f861238d0244ull, 0x622ca44f47397bc7ull, 0xdf4c40900db1585eull, 0x1335cbbe2d07fdd6ull, 0x2bfb526406b6b98aull, 0xb1349ad9a043d380ull, 0xa8bdfcdf02e6b376ull, 0xea232d8d0cd43b4dull, 0xd2df62c86b01f180ull, 0xbc691d0b098b6836ull, 0xec4ebb0b1d2f96cull, 0x6bd510d8c5b08b90ull, 0x10eecf4e2484b94cull, 0x816450de2f4fc168ull, 0x16602e0af2159bbaull, 0xade6db36e2195d6full, 0xd9dec9d43df53600ull, 0x2d91ead7e6b314f8ull, 0x70aa5f0103a5185cull, 0x95d8f78a8312921bull, 0xd506c0a5dad7c0cbull, 0x2df7d851d5a0edb0ull, 0xb2075175f36210c0ull, 0x3e68d00f8b4a2890ull, 0x264ef4278b6eea9full, 0x2e2a7e0af4abeeebull, 0x5e66704c907539d1ull, 0x67cdcc4da356bef5ull, 0x922f5dffb6e1b2e1ull, 0x7caceb607636ac77ull, 0xebd0116be140788cull, 0x4034cabd180a122eull, 0x1864aa8b04c4bb20ull, 0x951e0ebe017bbfb2ull, 0x51235d6359d12898ull, 0xe40f3bf1202ea691ull, 0x491399086832e87dull, 0x384062480a8abfdcull, 0x7bf30a5ca8fb3ef4ull, 0xbf3ceea15c128acfull, 0xb41db95aaa8b26ceull, 0xfe89eab928e63575ull, 0x30babd421eac2bcfull, 0xf39f13056fc11d5ull, 0x872e442ea8ef7c9eull, 0xe398d74e601ee261ull, 0x446c8c819c295dc5ull, 0x32646ad6857ec04full, 0x9ffc8f8e77d18623ull, 0xb76eb6fd5ae44bfbull, 0x85a4550765f3664aull, 0x9217f1be995c4a1eull, 0x78bc276d19d3ac77ull, 0x29ea546e43df93aull, 0xccbf6e2e0c564a18ull, 0x475d8bae69d9f2cfull, 0xc0137f897c62a0a1ull, 0x715f053df138141cull, 0x132f3f9f3c5cbcdbull, 0xd1d8ed06b69f76d4ull, 0xf87543abccd32cd6ull, 0xe30cce8bfe97cedfull, 0x9f244266060e6e5cull, 0xa7989f2046564870ull, 0x5e1cbee90a3ade3bull, 0x75877c28eadd1428ull, 0xeaab7cc285e0ef08ull, 0xb3005e7ce48b3e98ull, 0x9732a21d7d43719full, 0xbb00ac0d057ff74aull, 0x59cdbaaf5acacbfcull, 0x63178f16c81f5131ull, 0xe06dd5a209a374b4ull, 0xb16cbc35a1f8fb24ull, 0x8ef7449ec988415full, 0xe47589ba57a9fe51ull, 0x9d1c52de51c33228ull, 0x2ed28fee1d657f3dull, 0xbc5b515d59958469ull, 0x46282a345e381a06ull, 0x80db702cd8658344ull, 0x69d35a68149cc968ull, 0x48623315969bf60ull, 0x733345ad72103ebeull, 0x61ef8ecbe8f55efcull
};

uint64_t f(uint64_t x) {
    x ^= x << 13;
    x ^= x >> 7;
    x ^= x << 17;
    x *= 11816010119255748403ull;
    return x;
}

uint64_t verify(uint32_t round_num, uint64_t codeword) {

    uint64_t state = 9419517412519970297ull;
    uint64_t secret = codeword;

    uint8_t* y = (uint8_t*)&secret;
    state = f(state + y[0]);
    state *= 10245209052840570551ull;
    state = f(state + y[1]);
    state = f(state + y[2]);
    state *= 10245209052840570551ull;
    state = f(state + y[3]);
    state = f(state + (round_num & 0xFF));
    state = f(state + y[4]);
    state = f(state + y[5]);
    state *= 10245209052840570551ull;
    state = f(state + y[6]);
    state = f(state + y[7]);

    for (int i = 0; i < 35; i++) {
        state = f(state);
    }

    uint64_t ret = 0;
    for (int i = 0; i < 8; i++) {
        state = f(state);
        ret *= 0x100;
        ret += state & 0xFF;
    }

    return ret == hashes[round_num % 256];

}
