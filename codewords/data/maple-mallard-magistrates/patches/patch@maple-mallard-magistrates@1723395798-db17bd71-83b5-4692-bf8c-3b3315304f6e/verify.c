
#include <stdint.h>

uint64_t hashes[] = {
    0xccb13e849b802f0full, 0x4bd9922de730926dull, 0x6b0f55f72eb44bb5ull, 0xbd42b68386872286ull, 0x1abe5bf184698d92ull, 0x150b95cc73659190ull, 0xa52ea2df70a8887ull, 0x475b4bbb604e26b0ull, 0x239526ba0f5dcf46ull, 0xe0415bc1ee473785ull, 0xda8b527c1e00c2a5ull, 0xf93c240ab8712f3full, 0xa1b435ed88ebe4b3ull, 0x661a1a6e1ec41941ull, 0x3fc7b41b59351573ull, 0xa5cccb92cba0193bull, 0x84b9fc73ed0cc829ull, 0xba0f8b4abeef2446ull, 0x1e2460ca079da69full, 0xc4174dcdc42bf5e2ull, 0x46aaa9dcb9fac9ccull, 0xfc9b3682e91ea6b3ull, 0xbbdacd20c44f5715ull, 0x3f1d51edec0d2db1ull, 0x503a8c499b385c0eull, 0xa99091e815ff922full, 0x2dbbc067733b638full, 0xb9a6b7b0ffba2b95ull, 0xd1f89f4caccb0c7cull, 0x168e391739616dd3ull, 0x93e8c346c22d6f3bull, 0x745c46e88f0cb483ull, 0x5b2f4f7971399510ull, 0xa754b2176929531dull, 0x1d3bfbde814e9edfull, 0xdf8c8b94659388f1ull, 0xe4991a3c20a4fb74ull, 0xaea976705ca255adull, 0xd29d906d45bfc80dull, 0xf3dc1fcd1c60e457ull, 0x5098abb8dbc0efa2ull, 0x6d2d032b358fb64dull, 0x9a15532f7b072f85ull, 0x35838ebfc8ad20e6ull, 0xaf44d0cbea5db500ull, 0x4088df461c7a0c76ull, 0xb11ae07f67add847ull, 0xeaf97e4048d85d41ull, 0x51c760d00d43bd94ull, 0x88011b5e2830e3eull, 0xb651676ff3ea5309ull, 0x8c13b79697fe593full, 0xa9741ce81f69b934ull, 0x5cbee704b2070701ull, 0x4226144a5856c093ull, 0x7b2fb322baeb606cull, 0xfe11e78ec796d560ull, 0xe3b0854a0ebee308ull, 0xc8bd8a5da3c6abfaull, 0x610f65d926b4b3c8ull, 0x4c8e533d5fc57482ull, 0x721c74a0694f2d29ull, 0x908ffe852e5cd41bull, 0xf5407a4a94172f13ull, 0x257dff3cb429efaaull, 0xe49f14884795ea99ull, 0x1f699fc00dcf820full, 0x7df94e982d8d7c74ull, 0x2cda07cf26d461f1ull, 0x98d572b4d58a193bull, 0x497b4bbbbe77b17eull, 0x6acaf3d6a3c67fa3ull, 0x919e77e53e441838ull, 0xf0f19a27efa24f45ull, 0xe7782812aae3d20dull, 0xb17a6e102c80d112ull, 0xdec5d4cdd623dd46ull, 0xf2f16aa6effec74aull, 0x1575c93c3c7654f8ull, 0xc7e045a3e6a1a28ull, 0x4d1f45bf7c7ac045ull, 0x669efda289b8fbb2ull, 0x943b0da9aacdc46full, 0xc863494ba7c8d99aull, 0x671dd964f8ebb8e3ull, 0xad34d24d05b33880ull, 0x982d21a138d27f19ull, 0x31b1c4e5be359d88ull, 0xea1be7025276cee5ull, 0x34004ef669b160aaull, 0x1c807d5d0bcf6a06ull, 0xe8b52636fad51ceaull, 0xcc55f360a2854804ull, 0xe154c80347e1b24dull, 0x21dff2af9e537195ull, 0x95b62f49479dd8b3ull, 0x14249e5fd536106cull, 0x2c20848398134b77ull, 0xaa07e90030e08340ull, 0x45d9ee03d7262cd8ull, 0x738d6c6eacb532c6ull, 0x77079dfa7f0fd588ull, 0xbf74fa859e779b54ull, 0xfd30b8b77ab60549ull, 0xf28f0a34140826f2ull, 0xff70a69b027e3448ull, 0xe9b03b1b7bbdeeebull, 0x431d6d5b5dcbdeefull, 0x56e4fbdcc5907579ull, 0x1c4e8ce59621e142ull, 0x5db7a2ed4c9cbffaull, 0x9e373147bbb46747ull, 0x449841f5bc2f8be4ull, 0x938e17c7b2c1fccbull, 0x4e84cd96dd20cec1ull, 0xb2c588cb4292b566ull, 0x3b09255bbbf03941ull, 0xc1624ae51d7dac7ull, 0xf049dfa4dfd0a3beull, 0xc275efe6751f3b15ull, 0xda6f2373890a9087ull, 0x429403a9d293f2c9ull, 0x5a1e8ff1c22e21bull, 0xc726d89708b6e796ull, 0xa9f637cddac1f66full, 0xd1dc17a3c6d7a89full, 0xa0471d59f31814deull, 0x1ca6abe6bd582488ull, 0xe22973a70a3a2c8cull, 0x26b4057d11835600ull, 0xd94cc4d33c0c000cull, 0xefec714f33c9e84bull, 0xae67e192193f6b73ull, 0x6a8753319355b4bull, 0xf168dee5e2edd845ull, 0x786422aa33c35acaull, 0xf79cc95ed813172full, 0x360064e4e15e9e8full, 0xd5301cd4c9a99f6ull, 0x65a7c097ae2b8f44ull, 0xcbc697c04d1f198full, 0x18de27c308c04b55ull, 0xf196a30a0804a405ull, 0xd85d5bab60ba517dull, 0xa78689464e840b59ull, 0x1b49c1d84fd5e853ull, 0x251dbd50e4c540caull, 0x37358f08d21bb152ull, 0x218532a0b19ebdc8ull, 0x8e934ed43b83b2ddull, 0x33d5464eea25634full, 0xe19a51e7988bb877ull, 0x766c886509f1103aull, 0xf92e04e461651715ull, 0x3e70946b3b3bf72aull, 0x66ba0551d16ec813ull, 0xfb9eef46aebd9459ull, 0x1c488033d58895eeull, 0x7de1301c64142864ull, 0x4b41bdfab3246aecull, 0x65a33a4662de69a7ull, 0xf7d15251147b53cull, 0x31950070a8479976ull, 0x2e704c8865a58e9bull, 0xea318dd619117301ull, 0x998ae33efc85fc37ull, 0x410375b3760af02bull, 0x82e536b421e9d615ull, 0x61390d511133df6cull, 0x83b02bcd9ea3d099ull, 0x360c5a14b4934adeull, 0x3040d6b9e4558da4ull, 0x58722ac0250fcf6cull, 0x9be2fd8ed5d25dafull, 0xfacff64fd9529e9full, 0xcdeed5ee9f52165aull, 0x48ee03b1a803ff64ull, 0xc6eb0246d8f76e64ull, 0x19436101777d53d9ull, 0x95175bd52daf12aull, 0x874c305408707432ull, 0x4b23f5d4e5483840ull, 0x9229e358d48bf221ull, 0xfd10228a29ebde9full, 0xd09bbc0b553f3f83ull, 0x5e506268e205ad28ull, 0x70d87915c362c459ull, 0xff0296015561bd64ull, 0x36e203952e7a50ecull, 0x17dd5cdea7ee4971ull, 0xf4301ffa873cffcull, 0xf7c8a5cce770d679ull, 0x12f22d4dbdb009cdull, 0xea9d34785288659full, 0x8f9ab73c94c73ef6ull, 0x2630b23363892a0eull, 0xc821fb3afc85a233ull, 0x459d7c06e20dfd6eull, 0xa390e73220e8112dull, 0x9386e168f8f9d497ull, 0x105cecc73640acd5ull, 0x34d6098bac771735ull, 0x9ce9aeb9f80b5511ull, 0x391f776fe534ce53ull, 0xf60f79ab6878227aull, 0xaaa3367a6236fa3dull, 0xa62b817aded7ba53ull, 0x965b8bee254331a9ull, 0xf8fb3aa6a56cc0f1ull, 0x9819bfb8e374442aull, 0xeab170da7b97a06full, 0x3294c5cc0379e532ull, 0x4db9ccfdfc3b13bbull, 0x91ecef966935d35cull, 0x285070643a8255dfull, 0x41b192d1d8db92b1ull, 0x7be5dad31cf82f79ull, 0xb17450f6eb541850ull, 0x8d6444f81393c819ull, 0x47eb26709479a528ull, 0x87469cbb444e4696ull, 0xf83b2f56c88716full, 0xc273ad1c00de4121ull, 0xdaeb98af0086cf4eull, 0xf087b247c7ea0d9bull, 0x98ef44028c8998afull, 0x32725c52eccd7a62ull, 0x2830d4b91a921fa9ull, 0xd140b619df8a4379ull, 0x4e98d5c8dd66d891ull, 0x271125699fb26d67ull, 0xa324da7be15e32ecull, 0xb7068ca32e38ba5dull, 0x5a0aa25909efaecbull, 0x206e7410d22fdb7eull, 0x537bddea11edf2afull, 0x3709fb5cb83d794dull, 0x3b1d61cbccc9d09dull, 0x3c1c9eaf9259bf16ull, 0x3bfbce9512ac2113ull, 0x68e6e560e2a3ce5bull, 0x5cf8c36a38cebf70ull, 0xcb3612c02769eb48ull, 0x18604eee77eb92e1ull, 0xdcb6c68daa3860full, 0x709cfb2cba0d2931ull, 0x676febba032b6931ull, 0x3d57bb0666229ef3ull, 0xc2c3cc75dfce81aaull, 0x4b3bcb58e8eb54e0ull, 0x347a0a207e542a9eull, 0x4a5c54bac178f277ull, 0x4fbbdc43f1dae5daull, 0x866d15c578fcfd10ull, 0xe1c36ba87f087c6ull, 0x29cff007bf46820dull
};

uint64_t f(uint64_t x) {
    x ^= x << 13;
    x ^= x >> 7;
    x ^= x << 17;
    x *= 10598147161578216661ull;
    return x;
}

uint64_t verify(uint32_t round_num, uint64_t codeword) {

    uint64_t state = 12761476639503217811ull;
    uint64_t secret = codeword;

    uint8_t* y = (uint8_t*)&secret;
    state = f(state + y[0]);
    state *= 13273842385933507177ull;
    state = f(state + y[1]);
    state = f(state + y[2]);
    state *= 13273842385933507177ull;
    state = f(state + y[3]);
    state = f(state + (round_num & 0xFF));
    state = f(state + y[4]);
    state = f(state + y[5]);
    state *= 13273842385933507177ull;
    state = f(state + y[6]);
    state = f(state + y[7]);

    for (int i = 0; i < 35; i++) {
        state = f(state);
    }

    uint64_t ret = 0;
    for (int i = 0; i < 8; i++) {
        state = f(state);
        ret *= 0x100;
        ret += state & 0xFF;
    }

    return ret == hashes[round_num % 256];

}
