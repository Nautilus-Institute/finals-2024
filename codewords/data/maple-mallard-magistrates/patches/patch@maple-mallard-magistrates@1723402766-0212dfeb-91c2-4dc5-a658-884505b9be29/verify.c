
#include <stdint.h>

uint64_t hashes[] = {
    0x57eb592e03b81635ull, 0x1f8bad99b81a964dull, 0x691b4d7632365c8ull, 0x4b5a1fb140455a14ull, 0x6f3f117df10c40f9ull, 0x37e7c88637ba6449ull, 0x618b731fd6ac8e33ull, 0x594b67d47f1a6293ull, 0x8330f1cb3d429774ull, 0x3f1b024c7aa3273bull, 0x9e596cfa47421c8aull, 0x46988003102dbf11ull, 0x5b8ec1dfaba900e7ull, 0xa95440c7f0e75c57ull, 0xdb98ce21b4b713e9ull, 0xce8a8b6d46a081f6ull, 0xa9d17676ae0f72f3ull, 0x4c12df49c7869b46ull, 0xfacf95950f609cc1ull, 0x4b5f0d36b16b46b7ull, 0xbb181d28ed30e161ull, 0xf995b043be586d79ull, 0x27329cd5f12b7ecfull, 0xd7b79b71685270e7ull, 0x846255992a9db24cull, 0x5efbe9bd19b8b69dull, 0xf2fcfe2c1a9a0b06ull, 0x28614da2a266a804ull, 0x4bd24cd42a0524eull, 0x2409cf88dbf4c0eaull, 0xae0431a52a097d8dull, 0x54195886efe85815ull, 0x3c2380be2013d045ull, 0xe2580ca400ab3999ull, 0x5e7ffd058d9ab159ull, 0x52d92e3f9e4713e8ull, 0xd61284b3888efe02ull, 0x8772789d712676f2ull, 0x844f36e25ce83bbull, 0xc104d6fc68454ed1ull, 0xc619d269ef4d856dull, 0x3eba393cef3d7745ull, 0x423fd3448c74e6e1ull, 0x495ad166a596c209ull, 0x5408de4b770fd7aull, 0xe08867e68c8ccb3cull, 0x2f0e5896fb1433e5ull, 0xee9005b4204ef77dull, 0x54e815a6e048fda1ull, 0x4135ce94e50cb5d6ull, 0x7a37aca832eafe52ull, 0xe7f1ae61b883a4feull, 0x53458b80586409a4ull, 0x494f7cf325ec4d23ull, 0xdbe6b8540286ae25ull, 0x1c93430d9b8b9cb2ull, 0x107f4635c7102758ull, 0xd9843eb563cb1510ull, 0xd272668fa30a0456ull, 0xc4fa3664b690c6edull, 0xffcd644ae32e8e3cull, 0xc33464b06f4035a5ull, 0x14839748ee278726ull, 0xfe57f655467fdf4aull, 0x4b3fdbaca90e06aeull, 0x4501257594f380d3ull, 0xd2a7cf4863da134full, 0xfa5034b2e1f22f43ull, 0xd826859ee4bdc520ull, 0x65c12693387712d5ull, 0x2e85888c0c2d17d1ull, 0x5b5a35c92850fa77ull, 0xf9ef706b929a8e83ull, 0xd4025c78a97221b4ull, 0x58abd3bdbe7c19ceull, 0x50a127979b39d6full, 0xc777c81ed3f6faf6ull, 0xef98b142f3129e8ull, 0x6674bb55460057ceull, 0x24239168817ad20dull, 0x9a7208eb02767666ull, 0xe2dd8cc47730d13cull, 0x97cb20fd5d68d2e5ull, 0xafca6c80a53cf0e2ull, 0xc7461d45abac7b73ull, 0x9d4adc311b105e71ull, 0x3b414585846e0caeull, 0x9ffbb96526051df7ull, 0xacd53e43924b9b81ull, 0x3a068d46d80a334bull, 0xbfd31aa69a6a855full, 0x6d445a8422cf25c7ull, 0x4c563364b0ef2bfaull, 0x570fd48c7ff376b4ull, 0xc6b24bacdcd4f9b0ull, 0xe7d1d8e2d35c40ffull, 0x2a7f6434453d046bull, 0x10ef31ea88081c95ull, 0xe93e4e4270b7c5b1ull, 0xc8688a4eefa82972ull, 0x9d3c39cc4ee85d6cull, 0x52907f06e65b5565ull, 0x420d4681e7cb91e0ull, 0x3efffba2a2a65ee7ull, 0xcb557e7a7b1eef8cull, 0x4b556b2622a63a20ull, 0xb1aaed4d2a2ea065ull, 0x120e6e032e2dd384ull, 0xfbfb13bfc08679f9ull, 0xf6626bbe246b36d1ull, 0xa99fe1266decf64ull, 0xf37e520ee863d8b2ull, 0xec8b292573dff3dull, 0x292551dc19ce72a2ull, 0xe052aac5ae6b75c6ull, 0x47fb884ae0b7262bull, 0xefd1db1a52ca1539ull, 0x777816110e96cf2eull, 0x32694e94495a507bull, 0x7188796bc5b916cbull, 0x57ea41f3fc55117bull, 0xe5de4ade9fe1e0f5ull, 0xd3f765ec79e97e60ull, 0x3caf5b4ebf66f362ull, 0xc00e5137da77d771ull, 0x2e65fca803b0303bull, 0x76441c27df1ffe5dull, 0x720e189237fb7e53ull, 0xf1aebafc4b17a97full, 0x3ae19eefdb2bbdbaull, 0xb0bc186f796038a4ull, 0x1bcd0c686d7db25ull, 0x994858c1dcdaf6a0ull, 0xaf419ba19198e416ull, 0xf8dbd7e8051eb1cbull, 0xe424b9c76cb839c3ull, 0x1c4bfabd7ae7fcdeull, 0x8928bf32a2dfb1cull, 0xd915ffe92c64774cull, 0x44cee34208e81306ull, 0xe0ae61f77c35e10ull, 0x32c6aa5ad8323bc0ull, 0x1d00746effca52bfull, 0xb9f27e2d35900b2full, 0xa1c0f0f2632451a3ull, 0x46b6ddafbf7b553ull, 0x5c5d2ca61cc7921aull, 0xba6eeb6255932159ull, 0xafded7006800de9full, 0x9cce3108fe525071ull, 0x3458ac2fd1547fd3ull, 0x1fc55f75fc4bf6f7ull, 0xe970477c065ce2e2ull, 0xeda393a16b881317ull, 0x5fc5ad2e6c6cd03full, 0x194320d9e7d0ce7aull, 0xe17defaedf4acb31ull, 0x552e09dedb8b027cull, 0xe40504654f91660eull, 0x493e335314a8de72ull, 0xe9076bce77fde844ull, 0x3e6847efbeb9e48full, 0xf7ad9bdca55e2e42ull, 0xd0d567adc5b46430ull, 0x6ad325bb23b7f055ull, 0x4ce2312248ea9a06ull, 0xb2ea2d9346ca47e0ull, 0x19b20322323435dbull, 0xf2d96016ced52da9ull, 0x3945ed4dfe5c3d31ull, 0x44871843c1d7087aull, 0x53d61c60b668a418ull, 0xc928129c54942e9dull, 0x17725052a566567cull, 0x6157c0a80e7b8f1full, 0xd8ba9847bc0587aaull, 0x88ef3d964aed5ef4ull, 0xa0261bbcfd15692bull, 0x29d565f6dd44da57ull, 0x23fb7a29e357e831ull, 0x5157b71641b0a6ebull, 0x70cf342815e0d9a9ull, 0x70c4b6416dc5a13aull, 0xe7c1037de325f03dull, 0xf8672af86d1bed8eull, 0x3e8c50bd506fcc13ull, 0xc6d00fd12f4695cbull, 0xe54e2458f6bfd7f4ull, 0x9a8b517b79e78924ull, 0x77b46a311a4b851dull, 0x7453d9dd0962d772ull, 0x269dc8f9728e502cull, 0xbd51bed150d4dddbull, 0x54bb33b293a7d047ull, 0x9700de6aa9c0ef7bull, 0xc26e7e114bf4a1beull, 0xf19b56d56bef1bbaull, 0xc4f083f4ad57fde2ull, 0x959044ea265f46d3ull, 0x181ad330b4d69d91ull, 0x67d7a5085b09361aull, 0xbd625ca01c852689ull, 0x43d86a60a8707815ull, 0xcd2d80ac7bea0524ull, 0x6d5afa49d036e18dull, 0x6f4be0bf31845605ull, 0x5e81deab674e842full, 0x95d0b9b6e330cf45ull, 0xc8bd27839d0565daull, 0x3559c0bc541ee78ull, 0xc94d210bc042c322ull, 0xf398ff2af95e31c9ull, 0xae52a44ffd0205e2ull, 0x4cff3af7e974ec21ull, 0xafab39a61eace191ull, 0xfd2c05fbe1ad9530ull, 0xd1ea7da5784a4c65ull, 0x4e024074e67f33f0ull, 0xb9a608dbe753d621ull, 0xc065b33517be8b95ull, 0x413493a8bab3443aull, 0x2f60b0b44b92445bull, 0xbbd4a2d9b22907faull, 0x31179bb245b83ad4ull, 0x7b14c7430221119eull, 0x2f2667c4ac9f1b82ull, 0xc6dcf57c1ef9c079ull, 0x42eb0fbfb4518107ull, 0x6d949144f47907d0ull, 0x3b73d72f8e6be731ull, 0xff6423125c6ba381ull, 0xa439345d169b360eull, 0x4b5122228998b3f8ull, 0x470f2e540fc652e3ull, 0x24bc8eb70858d31full, 0xaf81d69b0f2cf1baull, 0x7d16f22ba6b6f3e5ull, 0x4109b81300d007efull, 0x2bd1a34b12503effull, 0x945624fed95484c3ull, 0xbfc433ec6f0f17b8ull, 0xa5eee9a850069779ull, 0x410617bb851bce9bull, 0x5aea3c043265d890ull, 0x71ffd4df7defcaa5ull, 0x8a9d0c3fe294caeeull, 0xc31aa37eddb23ed8ull, 0x9513f61a05a139aaull, 0x1f7bad1190e7ad23ull, 0xeee35dd5ce2ee976ull, 0xa551b9d0ae237200ull, 0x6a150be0ece57c68ull, 0x7cd9d730569551a5ull, 0xed88a2af42f6a60ull, 0x75f4ea00469cc1d6ull, 0xd9b3bad4dc857e78ull
};

uint64_t f(uint64_t x) {
    x ^= x << 13;
    x ^= x >> 7;
    x ^= x << 17;
    x *= 12559379171584877369ull;
    return x;
}

uint64_t verify(uint32_t round_num, uint64_t codeword) {

    uint64_t state = 11777224307916592687ull;
    uint64_t secret = codeword;

    uint8_t* y = (uint8_t*)&secret;
    state = f(state + y[0]);
    state *= 12266234776691332351ull;
    state = f(state + y[1]);
    state = f(state + y[2]);
    state *= 12266234776691332351ull;
    state = f(state + y[3]);
    state = f(state + (round_num & 0xFF));
    state = f(state + y[4]);
    state = f(state + y[5]);
    state *= 12266234776691332351ull;
    state = f(state + y[6]);
    state = f(state + y[7]);

    for (int i = 0; i < 32; i++) {
        state = f(state);
    }

    uint64_t ret = 0;
    for (int i = 0; i < 8; i++) {
        state = f(state);
        ret *= 0x100;
        ret += state & 0xFF;
    }
    ret ^= secret;

    return ret == hashes[round_num % 256];

}
